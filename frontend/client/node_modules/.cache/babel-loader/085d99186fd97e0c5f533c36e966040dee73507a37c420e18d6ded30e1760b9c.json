{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kamel.yehya\\\\Desktop\\\\TradeZ\\\\frontend\\\\client\\\\src\\\\pages\\\\EditItem\\\\index.jsx\",\n  _s = $RefreshSig$();\nimport ItemForm from \"components/ItemForm\";\nimport { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst EditItem = _ref => {\n  _s();\n  let {\n    getCookie\n  } = _ref;\n  const navigate = useNavigate();\n  const {\n    id\n  } = useParams();\n  const [data, setData] = useState(\"\");\n  const [selectedFile, setSelectedFile] = useState(\"\");\n  useEffect(() => {\n    getItemDetails();\n  }, []);\n  const getItemDetails = async () => {\n    const token = getCookie();\n    let reqInstance = axios.create({\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    const url = \"http://localhost:3000/api/item/\" + id;\n    await reqInstance.get(url, {\n      withCredentials: true,\n      baseURL: 'http://localhost:3000'\n    }).then(async _ref2 => {\n      let {\n        data\n      } = _ref2;\n      console.log(\"data: \", data);\n      setData(data);\n      const newFiles = [];\n      data.imagePaths.forEach(async (item, i) => {\n        console.log(\"item in foreach is: \", item);\n        const filename = item.split(\"\\\\\").pop();\n        fetch(item).then(response => response.blob()).then(blob => {\n          const file = new File([blob], fileName, {\n            type: blob.type\n          });\n          newFiles.push(file);\n          if (newFiles.length === paths.length) {\n            setFiles(newFiles);\n          }\n        });\n        const base64String = await getImg(item);\n        const buffer = Uint8Array.from(base64String, c => c.charCodeAt(0));\n        const blob = new Blob([buffer], {\n          type: ['image/jpeg']\n        });\n        console.log(\"blob: \", blob);\n        const img = new File([blob], filename, {\n          type: \"image/jpeg\"\n        });\n        dataTransfer.items.add(img);\n        const files = dataTransfer.files;\n        setSelectedFile(files);\n        console.log(\"files: \", files);\n      });\n    });\n  };\n  const getImg = async imageUrl => {\n    const token = getCookie();\n    let res = undefined;\n    let reqInstance = axios.create({\n      headers: {\n        Authorization: `Bearer ${token}`\n      }\n    });\n    const url = \"http://localhost:3000/api\" + imageUrl;\n    await reqInstance.get(url, {\n      withCredentials: true,\n      baseURL: 'http://localhost:3000'\n    }).then(_ref3 => {\n      let {\n        data\n      } = _ref3;\n      res = data;\n    });\n    return res;\n  };\n  const submitForm = async e => {\n    e.preventDefault();\n    const formData = new FormData();\n    formData.append(\"_id\", data._id);\n    formData.append(\"name\", data.name);\n    formData.append(\"approximateValue\", data.approximateValue);\n    formData.append(\"locationName\", data.locationName);\n    formData.append(\"description\", data.description);\n    for (let i = 0; i < selectedFile.length; i++) {\n      formData.append('imagesReferences', selectedFile[i]);\n    }\n    const token = getCookie();\n    let reqInstance = axios.create({\n      headers: {\n        'ContentType': 'multipart/form-data',\n        Authorization: `Bearer ${token}`\n      }\n    });\n    try {\n      const url = \"http://localhost:3000/api/item/edit/\" + id;\n      await reqInstance.put(url, formData, {\n        withCredentials: true,\n        baseURL: 'http://localhost:3000'\n      });\n      navigate(\"/items/mine\");\n    } catch (error) {\n      console.log(\"error: \", error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: data && selectedFile && /*#__PURE__*/_jsxDEV(ItemForm, {\n      data: data,\n      setData: setData,\n      selectedFile: selectedFile,\n      setSelectedFile: setSelectedFile,\n      submitForm: submitForm\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }, this)\n  }, void 0, false);\n};\n_s(EditItem, \"hjPVCEBHpzdQ8sRRDtrl8zUX8hc=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = EditItem;\nexport default EditItem;\nvar _c;\n$RefreshReg$(_c, \"EditItem\");","map":{"version":3,"names":["ItemForm","useState","useEffect","axios","useNavigate","useParams","EditItem","getCookie","navigate","id","data","setData","selectedFile","setSelectedFile","getItemDetails","token","reqInstance","create","headers","Authorization","url","get","withCredentials","baseURL","then","console","log","newFiles","imagePaths","forEach","item","i","filename","split","pop","fetch","response","blob","file","File","fileName","type","push","length","paths","setFiles","base64String","getImg","buffer","Uint8Array","from","c","charCodeAt","Blob","img","dataTransfer","items","add","files","imageUrl","res","undefined","submitForm","e","preventDefault","formData","FormData","append","_id","name","approximateValue","locationName","description","put","error"],"sources":["C:/Users/kamel.yehya/Desktop/TradeZ/frontend/client/src/pages/EditItem/index.jsx"],"sourcesContent":["import ItemForm from \"components/ItemForm\";\r\nimport { useState, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\n\r\nconst EditItem = ({ getCookie }) => {\r\n\r\n    const navigate = useNavigate();\r\n    const {id} = useParams();\r\n\r\n    const [data, setData] = useState(\"\");\r\n    const [selectedFile, setSelectedFile] = useState(\"\");\r\n\r\n    useEffect(() => {   \r\n        getItemDetails();\r\n    }, []);\r\n\r\n    const getItemDetails = async () => {\r\n\r\n        const token = getCookie();\r\n\r\n        let reqInstance = axios.create({\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n\r\n        const url = \"http://localhost:3000/api/item/\" + id;\r\n        await reqInstance.get(\r\n            url,\r\n            {\r\n                withCredentials: true,\r\n                baseURL: 'http://localhost:3000'\r\n            }\r\n        ).then(async ({data}) => {\r\n            console.log(\"data: \", data);\r\n            setData(data);\r\n\r\n            const newFiles = [];\r\n\r\n            data.imagePaths.forEach(async (item, i) => {\r\n                console.log(\"item in foreach is: \", item);\r\n\r\n                const filename = item.split(\"\\\\\").pop();\r\n                fetch(item)\r\n                    .then((response) => response.blob())\r\n                    .then((blob) => {    \r\n                        const file = new File([blob], fileName, { type: blob.type });\r\n                        newFiles.push(file);\r\n                        if (newFiles.length === paths.length) {\r\n                          setFiles(newFiles);\r\n                        }\r\n                    });\r\n                        \r\n                        const base64String = await getImg(item);\r\n                const buffer = Uint8Array.from(base64String, (c) => c.charCodeAt(0));\r\n                const blob = new Blob([buffer], { type: ['image/jpeg']})\r\n                console.log(\"blob: \", blob);\r\n                const img = new File([blob], filename, {type: \"image/jpeg\"});\r\n                dataTransfer.items.add(img);\r\n                const files = dataTransfer.files;\r\n                setSelectedFile(files);\r\n                console.log(\"files: \", files);\r\n            });\r\n    \r\n        });\r\n    };\r\n\r\n    const getImg = async (imageUrl) => {\r\n\r\n        const token = getCookie();\r\n        let res = undefined;\r\n\r\n        let reqInstance = axios.create({\r\n            headers: {\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n\r\n        const url = \"http://localhost:3000/api\" + imageUrl;\r\n        await reqInstance.get(\r\n            url,\r\n            {\r\n                withCredentials: true,\r\n                baseURL: 'http://localhost:3000'\r\n            }\r\n        ).then(({data}) => {\r\n            res = data;\r\n        });\r\n\r\n        return res;\r\n    };\r\n\r\n    const submitForm = async (e) => {\r\n        e.preventDefault();\r\n        const formData = new FormData();\r\n\r\n        formData.append(\"_id\", data._id);\r\n        formData.append(\"name\",  data.name);\r\n        formData.append(\"approximateValue\",  data.approximateValue);\r\n        formData.append(\"locationName\",  data.locationName);\r\n        formData.append(\"description\",  data.description);\r\n\r\n        for (let i = 0; i < selectedFile.length; i++) {\r\n            formData.append('imagesReferences', selectedFile[i]);\r\n        }\r\n\r\n        const token = getCookie();\r\n\r\n        let reqInstance = axios.create({\r\n            headers: {\r\n                'ContentType': 'multipart/form-data',\r\n                Authorization: `Bearer ${token}`\r\n            }\r\n        });\r\n\r\n\t\ttry {\r\n\t\t\tconst url = \"http://localhost:3000/api/item/edit/\" + id;\r\n\t\t\tawait reqInstance.put(url, formData, \r\n\t\t\t\t{\r\n\t\t\t\t\twithCredentials: true,\r\n\t\t\t\t\tbaseURL: 'http://localhost:3000'\r\n\t\t\t\t});\r\n\r\n\t\t\tnavigate(\"/items/mine\");\r\n\r\n\t\t} catch (error) { \r\n\t\t\tconsole.log(\"error: \", error);\r\n\t\t}\r\n    }    \r\n\r\n\treturn (\r\n        <>\r\n            {   \r\n                data && selectedFile &&\r\n                <ItemForm data={data} setData={setData} selectedFile={selectedFile} setSelectedFile={setSelectedFile} submitForm={submitForm} />\r\n            }\r\n        </>\r\n\t);\r\n};\r\n\r\nexport default EditItem;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}